#!/bin/sh
#
# Start a terminal (and X if necessary) with a shortcut with this setting:
#     C:\cygwin64\bin\run.exe /usr/bin/bash.exe -l -c ~/bin/startxterm

lockfile='/tmp/.X0-lock'
running=0
if [[ -e $lockfile ]]; then
    pid=`cat $lockfile`
    if [[ -e /proc/$pid ]]; then
        running=$pid
    else
        rm -f $lockfile
    fi
fi

if [[ -z $DISPLAY ]]; then
    export DISPLAY=:0
fi

if [[ $running -eq 0 ]]; then
    /usr/bin/startxwin -- :0 -multiwindow -clipboard -silent-dup-error -screen 0 3840 2160 -emulate3buttons
else
    /usr/bin/run /usr/bin/urxvt --wait -ls -display :0.0
fi
